<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>AntiTruffa — Statistiche</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:#f5f7fb; margin:0; color:#0f172a; }
    header, footer { background:#fff; border-bottom:1px solid #e2e8f0; }
    footer { border-top:1px solid #e2e8f0; border-bottom:none; }
    .wrap { max-width: 980px; margin:0 auto; padding:18px; }
    .card { background:#fff; border:1px solid #e2e8f0; border-radius:18px; padding:18px; box-shadow: 0 1px 2px rgba(15,23,42,.06); }
    .grid { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:16px; margin-top:16px; }
    @media (max-width: 820px){ .grid { grid-template-columns: 1fr; } }
    .muted { color:#64748b; font-size:12px; }
    .row { display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .pill { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px; background:#f1f5f9; border:1px solid #e2e8f0; padding:4px 8px; border-radius:999px; }
    a { color:#2563eb; text-decoration:none; font-weight:700; }
  </style>
</head>
<body>
<header>
  <div class="wrap row">
    <div style="font-weight:800;">AntiTruffa</div>
    <div class="row">
      <a href="/">Verifica</a>
      <a href="/stats">Statistiche</a>
    </div>
  </div>
</header>

<main class="wrap">
  <div>
    <h2 style="margin:0;">Statistiche (ultimi {{ window_days }} giorni)</h2>
    <div class="muted">Dati aggregati da segnalazioni anonime (no contenuti completi).</div>
  </div>

  <div class="grid">
    <div class="card">
      <div class="muted">Totale segnalazioni</div>
      <div style="font-size:34px; font-weight:900;">{{ total_reports }}</div>
    </div>
    <div class="card">
      <div style="font-weight:800; margin-bottom:8px;">Per livello rischio</div>
      <div class="row"><span>Basso</span><b>{{ by_level.basso }}</b></div>
      <div class="row"><span>Medio</span><b>{{ by_level.medio }}</b></div>
      <div class="row"><span>Alto</span><b>{{ by_level.alto }}</b></div>
    </div>
    <div class="card">
      <div style="font-weight:800; margin-bottom:8px;">Per tipo</div>
      <div class="row"><span>Testo</span><b>{{ by_type.text }}</b></div>
      <div class="row"><span>Immagini</span><b>{{ by_type.image }}</b></div>
    </div>
  </div>

  <div class="grid" style="grid-template-columns: 1fr 1fr; margin-top:16px;">
    <div class="card">
      <div style="font-weight:800; margin-bottom:10px;">Categorie più frequenti</div>
      {% if top_categories|length == 0 %}
        <div class="muted">Nessun dato ancora.</div>
      {% else %}
        {% for c in top_categories %}
          <div class="row" style="margin:6px 0;">
            <span class="pill">{{ c.category }}</span>
            <b>{{ c.count }}</b>
          </div>
        {% endfor %}
      {% endif %}
    </div>

    <div class="card">
      <div style="font-weight:800; margin-bottom:10px;">Segnali più frequenti</div>
      {% if top_signals|length == 0 %}
        <div class="muted">Nessun dato ancora.</div>
      {% else %}
        {% for s in top_signals %}
          <div class="row" style="margin:6px 0;">
            <span class="pill">{{ s.signal }}</span>
            <b>{{ s.count }}</b>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>

  <div class="card" style="margin-top:16px;">
    <div style="font-weight:800; margin-bottom:10px;">Trend giornaliero</div>
    {% if trend|length == 0 %}
      <div class="muted">Nessun dato ancora.</div>
    {% else %}
      <div class="muted" style="margin-bottom:8px;">(Per ora elenco. Se vuoi, aggiungiamo grafico.)</div>
      <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:10px;">
        {% for t in trend %}
          <div style="border:1px solid #e2e8f0; border-radius:14px; padding:10px; background:#fff;" class="row">
            <span class="muted">{{ t.day }}</span>
            <b>{{ t.count }}</b>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</main>

<footer>
  <div class="wrap muted">⚠️ Valutazione probabilistica, non prova. Non inserire dati sensibili.</div>
</footer>
</body>
</html>
